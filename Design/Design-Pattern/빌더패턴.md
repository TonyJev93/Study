# 빌더 패턴

- 생성 패턴에 속함
- 빌더 패턴은 **복잡한 객체를 생성하는 방법**을 정의하는 클래스와 **표현하는 방법을 정의**하는 클래스를 별도로 분리하여, 서로 다른 표현이라도 이를 생성할 수 있는 **동일한 절차를 제공하는 패턴**이다.
- 빌더 패턴은 생성해야 되는 객체가 **Optional 한 속성을 많이 가질 때** 빛을 발휘한다.

### 필요성

- `팩토리 패턴` or `추상 팩토리 패턴`을 통해 객체 생성 시 속성 값이 많을 때 아래와 같은 이슈가 발생
    - 클라이언트에서 팩토리 클래스로 많은 파라미터를 넘겨주어야 함. 이는 타입, 순서 등에 대한 관리가 어렵고 실수가 발생할 확률이 높아진다.
    - 필요 없는 파라미터에 대해 null 값을 일일이 넘겨주어야 함.
    - 생성해야 하는 sub class 가 무거워지고 복잡해짐에 따라 팩토리 클래스 또한 복잡해짐.
- 빌더패턴은 이러한 문제들을 해결하기 위해 별도의 Builder 클래스를 제공한다.
    - 필수 입력값은 생성자를 통해 강제화 함
    - 선택적인 값들에 대해서는 메서드를 통해 step-by-step 으로 값을 입력받음.
    - 최종적으로 build() 메소드를 통해 하나의 인스턴스를 리턴한다.

### 구현 방법

1. 빌더 클래스를 `Static Nested Class` 로 생성. 관례적으로 `클래스 이름 + Builder` 로 네이밍 한다.
2. 빌더 클래스의 생성자는 `public` 으로 함. 필수 값에 대해서는 생성자의 파라미터로 받도록 한다.
3. 옵셔널한 값들에 대해서는 각각의 속성마다 메소드로 제공. 메소드의 리턴값은 빌더 객체 자신이어야 한다.
4. 빌더 클래스 내부에 최종 생성된 결과물을 리턴하는 `build()` 메소드를 정의한다. `build()` 메소드를 통해서만 객체 생성이 가능하도록 생성 대상인 클래스의 생성자는 `private` 으로 막아둔다.

### 유의사항

- 생성 대상 클래스는 `setter` 메소드와 `public` 생성자는 제공하지 않는 것이 좋다. (오직 `Builder` 클래스를 통해서만 생성이 가능하기 위해)

## 고찰

- 개인적으로 `Builder class` 를 직접 구현해서 사용해본적은 없고, `Lombok` 에서 제공해주는 `@Builder` 어노테이션을 자주 사용한 것 같다.
- `@Builder` 를 사용하면서 느낀점은 필수 입력값에 대해 별도의 `validation check` 를 수행하는 method 를 구현 해줘야 한다는 점이 개발자의 실수를 이끌 수 있다는 생각을
  했다.(`validation check` 구현이 강제가 아니다보니 누락하는 경우 종종 있음.)
- 그리고 `@Builder` 를 public 으로 제공해주면 이를 사용하는 `Client` 측면에서 너무 다채로운 객체 생성이 가능하다 보니 객체 생성에 있어 자유도가 높아져 일관성이 없고 재사용성도 떨어진다고 생각한다.
- 그래서 나의 경우 `@Builder` 를 private 으로 막아두고 객체 내부에서 `@Builder`를 사용하는 `Static factory method`를 구현하여 public 으로 제공하여 사용한다.
- 그럼 굳이 `@Builder`를 사용할 필요가 있을까 싶은 생각에 현타가 올때도 있다.. `@Builder`를 잘못 사용하는 예시 같다.. 근데 `@Builder`를 public 으로 뚫어주긴 좀 싫다.. 개발자는 쉽게 믿을 수 없기 때문에 ..;;;